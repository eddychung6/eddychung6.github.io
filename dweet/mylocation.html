<!DOCTYPE HTML>
<html>
<head>
<script src='https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.js'></script>
<link href='https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.css' rel='stylesheet' />
</head>
<body>
<div id='map' style='width: 400px; height: 300px;'></div>
<script>
var gotGEO;
var callloaddoc = function loadDoc() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      
	var jsonresult = JSON.parse(this.responseText);
	console.log(jsonresult);
	var currentdate = new Date(); 
	var datetime = "Last Sync: " + currentdate.getDate() + "/"
                + (currentdate.getMonth()+1)  + "/" 
                + currentdate.getFullYear() + " @ "  
                + currentdate.getHours() + ":"  
                + currentdate.getMinutes() + ":" 
                + currentdate.getSeconds();
  //console.log(jsonresult.with[0].content.body);
  //console.log(datetime);
  //document.body.textContent = jsonresult.with[0].content.content;
		var allcontent = jsonresult.with[0].content;
		console.log(allcontent);
    }
  };
  xhttp.open("GET", "https://dweet.io/get/latest/dweet/for/NbMHpe", true);
  xhttp.send();
}

//setInterval(callloaddoc, 60000);

function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);
  } else { 
    //x.innerHTML = "Geolocation is not supported by this browser.";
  }
}

function showPosition(position) {
	//console.log("Latitude: " + position.coords.latitude + "<br>Longitude: " + position.coords.longitude);
  //x.innerHTML = "Latitude: " + position.coords.latitude + "<br>Longitude: " + position.coords.longitude;
	var geo = {
		Latitude:position.coords.latitude,
		Longitude:position.coords.longitude,
	};
	window.gotGEO = geo;
	console.log(window.gotGEO);
	
	var ll = new mapboxgl.LngLat(position.coords.longitude,position.coords.latitude);
; // = -123.9749
	
	mapboxgl.accessToken = 'pk.eyJ1IjoiZWRkeWNodW5nIiwiYSI6ImNrZDg3YXptYjA2dHQycnAyaXg0Y2cxY2MifQ.QqgFaTvEVw_obXSHrzDfIw';
var map = new mapboxgl.Map({
container: 'map',
style: 'mapbox://styles/mapbox/streets-v11', // stylesheet location
center: [ll.lng, ll.lat], // starting position [lng, lat]
zoom: 9 // starting zoom
});
	
}
getLocation();
//console.log(window.gotGEO);

</script>
</body>
<script>

</script>
</html>